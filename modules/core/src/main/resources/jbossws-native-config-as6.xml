<?xml version="1.0" encoding="UTF-8"?>

<deployment xmlns="urn:jboss:bean-deployer:2.0">

  <!-- The registry for web service endpoints -->
  <bean name="WSEndpointRegistry" class="org.jboss.wsf.framework.management.ManagedEndpointRegistry">
    <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
  </bean>

  <!-- A subscription manager for WS-Eventing -->
  <bean name="WSSubscriptionManager" class="org.jboss.ws.extensions.eventing.mgmt.SubscriptionManager">
    <property name="bindAddress">${jboss.bind.address}</property>
  </bean>

  <!-- This should actually be in the stack-agnostic config file, it's here to avoid installing a CI -->
  <bean name="WSDescriptorParser" class="org.jboss.wsf.framework.deployment.WebservicesDescriptorParserImpl">
    <property name="descriptorName">webservices.xml</property>
  </bean>

  <!-- Installed Record Processors-->
  <bean name="WSMemoryBufferRecorder" class="org.jboss.wsf.framework.management.recording.MemoryBufferRecorder">
    <property name="recording">false</property>
  </bean>
  <bean name="WSLogRecorder" class="org.jboss.wsf.framework.management.recording.LogRecorder">
    <property name="recording">false</property>
  </bean>

  <!-- The stack specific deployment aspects -->
  <bean name="WSNativeContextPropertiesDeploymentAspect" class="org.jboss.wsf.framework.deployment.ContextPropertiesDeploymentAspect">
    <property name="provides">ContextProperties, StackDescriptor</property>
    <property name="contextProperties">
      <map keyClass="java.lang.String" valueClass="java.lang.String">
        <entry>
          <key>stack.transport.class</key>
          <value>org.jboss.wsf.stack.jbws.EndpointServlet</value>
        </entry>
      </map>
    </property>
  </bean>

  <bean name="WSNativeEagerInitializeDeploymentAspect" class="org.jboss.wsf.stack.jbws.EagerInitializeDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel</property>
    <property name="provides">InitializedMetaDataModel</property>
  </bean>

  <bean name="WSNativeEndpointHandlerDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointHandlerDeploymentAspect">
    <property name="requires">ContainerMetaData</property>
    <property name="provides">StackEndpointHandler</property>
  </bean>

  <bean name="WSNativeEndpointRecordProcessorDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointRecordProcessorDeploymentAspect">
    <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
    <property name="requires">RegisteredEndpoint</property>
    <property name="provides">EndpointRecordProcessors</property>
    <property name="processors">
      <list class="java.util.ArrayList" elementClass="org.jboss.wsf.spi.management.recording.RecordProcessor">
        <inject bean="WSMemoryBufferRecorder"/>
        <inject bean="WSLogRecorder"/>
      </list>
    </property>
  </bean>

  <bean name="WSNativeEventingDeploymentAspect" class="org.jboss.wsf.stack.jbws.EventingDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel</property>
  </bean>

  <bean name="WSNativePublishContractDeploymentAspect" class="org.jboss.wsf.stack.jbws.PublishContractDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel, JAXBIntros</property>
    <property name="provides">PublishedContract</property>
  </bean>

  <bean name="WSNativeServiceEndpointInvokerDeploymentAspect" class="org.jboss.wsf.stack.jbws.ServiceEndpointInvokerDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel</property>
  </bean>

  <bean name="WSNativeRMDeploymentAspect" class="org.jboss.ws.extensions.wsrm.server.RMDeploymentAspect">
    <property name="requires">StackEndpointHandler, UnifiedMetaDataModel</property>
  </bean>

  <bean name="WSNativeUnifiedMetaDataDeploymentAspect" class="org.jboss.wsf.stack.jbws.UnifiedMetaDataDeploymentAspect">
    <property name="requires">ContainerMetaData, URLPattern, EndpointAddress, VFSRoot, JAXBIntros</property>
    <property name="provides">UnifiedMetaDataModel</property>
  </bean>

  <bean name="WSJAXBIntroDeploymentAspect" class="org.jboss.wsf.framework.deployment.JAXBIntroDeploymentAspect">
    <property name="provides">JAXBIntros</property>
  </bean>

</deployment>
