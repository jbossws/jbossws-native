<?xml version="1.0" encoding="UTF-8"?>
<deployment xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="urn:jboss:bean-deployer:2.0 bean-deployer_2_0.xsd"
            xmlns="urn:jboss:bean-deployer:2.0">

   <!--
      ======================================================================
      SPI Implementations
      ======================================================================
   -->

   <bean name="WSKernelLocator" class="org.jboss.wsf.spi.util.KernelLocator">
      <property name="kernel"><inject bean="jboss.kernel:service=Kernel"/></property>
   </bean>

   <bean name="WSServerConfig" class="org.jboss.wsf.stack.jbws.embedded.StandaloneServerConfig">
      <property name="webServiceHost">localhost</property>
      <property name="modifySOAPAddress">true</property>
   </bean>

   <!-- The registry for web service endpoints -->
   <bean name="WSEndpointRegistry" class="org.jboss.wsf.framework.management.DefaultEndpointRegistry"/>

   <!--
      ======================================================================
      Standalone DeploymentAspectManager
      ======================================================================
   -->

   <bean name="WSDeploymentAspectManagerJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectManagerImpl">
      <property name="name">WSDeploymentAspectManagerJSE</property>
   </bean>

   <!--
      ======================================================================
      Container deployment aspects
      ======================================================================
   -->

   <bean name="WSEndpointLifecycleDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointLifecycleDeploymentAspect">
      <property name="requires">LAST_DEPLOYMENT_ASPECT</property>
   </bean>

   <bean name="WSEndpointRegistryDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointRegistryDeploymentAspect">
      <property name="provides">RegisteredEndpoint</property>
   </bean>

   <bean name="WSHttpTransportDeploymentAspect" class="org.jboss.wsf.stack.jbws.embedded.HttpEndpointPublishAspect">
      <property name="requires">RegisteredEndpoint</property>
      <property name="provides">HttpTransport</property>
   </bean>

   <bean name="WSDeploymentAspectInstallerJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
      <property name="manager"><inject bean="WSDeploymentAspectManagerJSE"/></property>
      <property name="sortAspectsOnCreate">false</property>
      <property name="aspects">
         <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
            <inject bean="WSEndpointRegistryDeploymentAspect"/>
            <inject bean="WSEndpointLifecycleDeploymentAspect"/>
         </set>
      </property>
   </bean>

   <!--
      ==============================================================================
      Stack deployment aspects
      ==============================================================================
   -->

   <bean name="WSNativeEagerInitializeDeploymentAspect" class="org.jboss.wsf.stack.jbws.EagerInitializeDeploymentAspect">
      <property name="requires">UnifiedMetaDataModel</property>
      <property name="provides">InitializedMetaDataModel</property>
   </bean>

   <bean name="WSNativeEndpointHandlerDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointHandlerDeploymentAspect">
      <!--property name="requires">ContainerEndpointHandler, ContainerMetaData</property-->
      <property name="provides">StackEndpointHandler</property>
   </bean>

   <bean name="WSNativeEventingDeploymentAspect" class="org.jboss.wsf.stack.jbws.EventingDeploymentAspect">
      <property name="requires">UnifiedMetaDataModel</property>
   </bean>

   <bean name="WSNativePublishContractDeploymentAspect" class="org.jboss.wsf.stack.jbws.PublishContractDeploymentAspect">
      <property name="requires">UnifiedMetaDataModel</property>
      <property name="provides">PublishedContract</property>
   </bean>

   <bean name="WSNativeServiceEndpointInvokerDeploymentAspect" class="org.jboss.wsf.stack.jbws.ServiceEndpointInvokerDeploymentAspect">
      <property name="requires">UnifiedMetaDataModel</property>
   </bean>

   <bean name="WSNativeRMDeploymentAspect" class="org.jboss.ws.extensions.wsrm.server.RMDeploymentAspect">
      <property name="requires">StackEndpointHandler, UnifiedMetaDataModel</property>
   </bean>

   <bean name="WSNativeUnifiedMetaDataDeploymentAspect" class="org.jboss.wsf.stack.jbws.UnifiedMetaDataDeploymentAspect">
      <property name="provides">UnifiedMetaDataModel</property>
   </bean>

   <!-- Deployment aspect installer -->

   <bean name="WSNativeDeploymentAspectInstallerJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
      <property name="manager"><inject bean="WSDeploymentAspectManagerJSE"/></property>
      <property name="sortAspectsOnCreate">true</property>
      <property name="aspects">
         <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
            <inject bean="WSNativeEndpointHandlerDeploymentAspect"/>
            <inject bean="WSNativeEventingDeploymentAspect"/>
            <inject bean="WSNativePublishContractDeploymentAspect"/>
            <inject bean="WSNativeServiceEndpointInvokerDeploymentAspect"/>
            <inject bean="WSNativeRMDeploymentAspect"/>
            <inject bean="WSNativeUnifiedMetaDataDeploymentAspect"/>
            <inject bean="WSNativeEagerInitializeDeploymentAspect"/>
            <inject bean="WSHttpTransportDeploymentAspect"/>
         </set>
      </property>
      <depends>WSDeploymentAspectManagerJSE</depends>
   </bean>

   <!--
      ==============================================================================
      Stack specific beans (not SPI)
      ==============================================================================
   -->

   <!-- A subscription manager for WS-Eventing -->
   <bean name="WSSubscriptionManager" class="org.jboss.ws.extensions.eventing.mgmt.SubscriptionManager">
      <property name="bindAddress">localhost</property>
   </bean>

</deployment>