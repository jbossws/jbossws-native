<?xml version="1.0" encoding="UTF-8"?>

<!-- $Id:build.xml 1125 2006-10-03 15:45:31Z thomas.diesler@jboss.com $ -->

<project default="main" basedir="../.." name="JBossWS Examples">

  <property name="chapter" value="jaxws/retail"/>
  <property name="sample.path" value="jaxws/samples/retail"/>
  <property name="java.dir" value="${basedir}/${chapter}/java"/>
  <property name="resources.dir" value="${basedir}/${chapter}/resources"/>

  <import file="${basedir}/common/imported-build.xml"/>

  <!--
  Build the test deployments
  -->
  <target name="jars" depends="compile,copy-resources" 
    description="build the deployments">
    
    <!-- jaxws-samples-retail -->
    <jar jarfile="${build.test.dir}/libs/jaxws-samples-retail.ejb3">
      <fileset dir="${build.test.dir}/classes">
        <include name="org/jboss/test/ws/jaxws/samples/retail/EJB3Bean01.class"/>
        <include name="org/jboss/test/ws/jaxws/samples/retail/EJB3RemoteInterface.class"/>
      </fileset>
      <fileset dir="${build.test.dir}/resources/jaxws/samples/retail">
        <include name="config/ServerHandlers.xml"/>
      </fileset>    	
    </jar>
    <jar jarfile="${build.test.dir}/libs/jaxws-samples-retail-client.jar">
      <fileset dir="${build.test.dir}/classes">
        <include name="org/jboss/test/ws/jaxws/samples/retail/EndpointInterface.class"/>
      </fileset>
      <metainf dir="${build.test.dir}/resources/jaxws/samples/retail/META-INF">
        <include name="application-client.xml"/>
        <include name="jboss-client.xml"/>
        <include name="jaxrpc-mapping.xml"/>
        <include name="wsdl/**"/>
      </metainf>
    </jar>
    
  </target>

  <!--
  Run the testsuite
  -->
  <target name="tests" depends="jars" description="run the testsuite" if="only-on-jboss-jdk15">
    <antcall target="test">
      <param name="test" value="${sample.path}"/>
    </antcall>
  </target>

</project>