<?xml version="1.0" encoding="UTF-8"?>

<!-- ====================================================================== -->
<!--                                                                        -->
<!--  JBoss, the OpenSource J2EE webOS                                      -->
<!--                                                                        -->
<!--  Distributable under LGPL license.                                     -->
<!--  See terms of license at http://www.gnu.org.                           -->
<!--                                                                        -->
<!-- ====================================================================== -->

<!-- $Id: macros-deploy-native.xml 4081 2007-08-02 09:23:17Z thomas.diesler@jboss.com $ -->

<project>
  
  <patternset id="bin.patternset">
    <include name="wsconsume.*"/>
    <include name="wsprovide.*"/>
    <include name="wsrunclient.*"/>
    <include name="wstools.*"/>
  </patternset>

  <patternset id="client.stack.patternset">
    <include name="jboss-jaxrpc.jar"/>
    <include name="jboss-jaxws.jar"/>
    <include name="jboss-jaxws-ext.jar"/>
    <include name="jboss-saaj.jar"/>
    <include name="jbossws-client.jar"/>
  </patternset>

  <patternset id="client.patternset">
    <include name="jaxb-api.jar"/>
    <include name="jaxb-impl.jar"/>
    <include name="jaxb-xjc.jar"/>
    <include name="jaxws-tools.jar"/>
    <include name="jaxws-rt.jar"/>
    <include name="policy.jar"/>
    <include name="stax-ex.jar"/>
    <include name="streambuffer.jar"/>
    <include name="wsdl4j.jar"/>
  </patternset>

  <patternset id="bc.patternset">
    <include name="jbossws-wsconsume-impl.jar"/>
    <include name="jbossws-integration.jar"/>
  </patternset>

  <patternset id="lib.patternset">
    <include name="jaxb-api.jar"/>
    <include name="jaxb-impl.jar"/>
  </patternset>

  <patternset id="native.patternset">
    <include name="jboss-jaxrpc.jar"/>
    <include name="jboss-jaxws.jar"/>
    <include name="jboss-jaxws-ext.jar"/>
    <include name="jboss-saaj.jar"/>
  </patternset>

  <!-- ================================================================== -->
  <!-- Deploy Endorsed                                                    -->
  <!-- ================================================================== -->
  
  <!-- Deploy API jars to lib/endorsed for usage with jdk1.6 -->
  <macrodef name="macro-deploy-endorsed">
    <attribute name="jbosshome"/>
    <attribute name="stacklibs"/>
    <attribute name="thirdpartylibs"/>
    <sequential>
      <copy todir="@{jbosshome}/lib/endorsed" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <include name="jaxb-api.jar"/>
        </fileset>
        <fileset dir="@{stacklibs}">
          <patternset refid="native.patternset"/>
        </fileset>
      </copy>
    </sequential>
  </macrodef>
  
  <!-- Undeploy API jars from lib/endorsed -->
  <macrodef name="macro-undeploy-endorsed">
    <attribute name="jbosshome"/>
    <sequential>
      <delete>
        <fileset dir="@{jbosshome}/lib/endorsed">
          <include name="jaxb-api.jar"/>
          <patternset refid="native.patternset"/>
        </fileset>
      </delete>
    </sequential>
  </macrodef>
  
  <!-- ================================================================== -->
  <!-- Deployment  JBoss-4.0.5                                            -->
  <!-- ================================================================== -->
  
  <macrodef name="macro-deploy-native405">
    <attribute name="stacklibs"/>
    <attribute name="thirdpartylibs"/>
    <sequential>
      <fail message="Not available: ${jboss405.available.file}" unless="jboss405.available"/>
      
      <!-- BIN SCRIPTS -->
      <unzip dest="${jboss405.home}/bin" src="@{stacklibs}/jbossws-core-scripts.zip"/>
      <chmod dir="${jboss405.home}/bin" perm="+x" includes="*.sh"/>
      
      <!-- CLIENT JARS -->
      <copy todir="${jboss405.home}/client" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="client.stack.patternset"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <patternset refid="client.patternset"/>
          <!-- AS 4.0.5 specific jars -->
          <include name="jbossws-jboss40.jar"/>
          <include name="jboss-xml-binding.jar"/>
          <include name="stax-api.jar"/>
          <include name="wstx.jar"/>
        </fileset>
      </copy>
      
      <!-- SERVER JARS -->
      <copy todir="${jboss405.home}/lib" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <!-- AS 4.0.5 specific jars -->
          <include name="jboss-xml-binding.jar"/>
        </fileset>
      </copy>
      <copy todir="${jboss405.home}/server/${jboss.server.instance}/lib" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="native.patternset"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <!-- AS 4.0.5 specific jars -->
          <include name="jbossws-jboss40.jar"/>
          <include name="wsdl4j.jar"/>
        </fileset>
      </copy>
      <delete dir="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws14.sar"/>
      <mkdir dir="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <unjar dest="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar" src="@{stacklibs}/jbossws-native40.sar"/>
      <mkdir dir="${jboss405.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
      <unzip dest="${jboss405.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <macrodef name="macro-deploy-native405-no-ejb3">
    <sequential>
      
      <move tofile="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/META-INF/jboss-service-ejb3.xml"
        file="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/META-INF/jboss-service.xml"/>
      <move tofile="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/META-INF/jboss-service.xml"
        file="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/META-INF/jboss-service-no-ejb3.xml"/>
      
      <move tofile="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/jbossws.beans/META-INF/jboss-beans-ejb3.xml"
        file="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/jbossws.beans/META-INF/jboss-beans.xml"/>
      <move tofile="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/jbossws.beans/META-INF/jboss-beans.xml"
        file="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar/jbossws.beans/META-INF/jboss-beans-no-ejb3.xml"/>
      
    </sequential>
  </macrodef>
  
  <macrodef name="macro-undeploy-native405">
    <sequential>
      <fail message="Not available: ${jboss405.available.file}" unless="jboss405.available"/>
      <delete>
        
        <!-- BIN SCRIPTS -->
        <fileset dir="${jboss405.home}/bin">
          <patternset refid="bin.patternset"/>
        </fileset>
        
        <!-- CLIENT JARS -->
        <fileset dir="${jboss405.home}/client">
          <patternset refid="client.stack.patternset"/>
          <patternset refid="client.patternset"/>
          <patternset refid="bc.patternset"/>
          <!-- AS 4.0.5 specific jars -->
          <include name="jbossws14-client.jar"/>
          <include name="jbossws-jboss40.jar"/>
          <include name="jboss-xml-binding.jar"/>
          <include name="stax-api.jar"/>
          <include name="wstx.jar"/>
        </fileset>
        
        <!-- SERVER JARS -->
        <fileset dir="${jboss405.home}/lib">
          <patternset refid="bc.patternset"/>
          <!-- AS 4.0.5 specific jars -->
          <include name="jboss-xml-binding.jar"/>
        </fileset>
        <fileset dir="${jboss405.home}/server/${jboss.server.instance}/lib">
          <patternset refid="native.patternset"/>
          <!-- AS 4.0.5 specific jars -->
          <include name="jbossws-jboss40.jar"/>
          <include name="wsdl4j.jar"/>
        </fileset>
      </delete>
      <delete dir="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <delete dir="${jboss405.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
      <!-- Remove only, do not deploy -->
      <delete dir="${jboss405.home}/server/${jboss.server.instance}/deploy/jbossws14.sar"/>
    </sequential>
  </macrodef>
  
  <!-- ================================================================== -->
  <!-- Deployment JBoss-4.2.1                                             -->
  <!-- ================================================================== -->
  
  <macrodef name="macro-deploy-native421">
    <attribute name="stacklibs"/>
    <attribute name="thirdpartylibs"/>
    <sequential>
      <fail message="Not available: ${jboss421.available.file}" unless="jboss421.available"/>
      
      <!-- BIN SCRIPTS -->
      <unzip dest="${jboss421.home}/bin" src="@{stacklibs}/jbossws-core-scripts.zip"/>
      <chmod dir="${jboss421.home}/bin" perm="+x" includes="*.sh"/>
      
      <!-- CLIENT JARS -->
      <copy todir="${jboss421.home}/client" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="client.stack.patternset"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <patternset refid="client.patternset"/>
          <!-- AS 4.2.1 specific jars -->
          <include name="jbossws-jboss421.jar"/>
          <include name="jboss-xml-binding.jar"/>
        </fileset>
      </copy>
      
      <!-- SERVER JARS -->
      <copy todir="${jboss421.home}/lib" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <!-- AS 4.2.1 specific jars -->
          <include name="jboss-xml-binding.jar"/>
        </fileset>
      </copy>
      <copy todir="${jboss421.home}/server/${jboss.server.instance}/lib" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <!-- AS 4.2.1 specific jars -->
          <include name="jbossws-jboss421.jar"/>
        </fileset>
      </copy>
      <mkdir dir="${jboss421.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <unjar dest="${jboss421.home}/server/${jboss.server.instance}/deploy/jbossws.sar" src="@{stacklibs}/jbossws-native42.sar"/>
      <mkdir dir="${jboss421.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
      <unzip dest="${jboss421.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <macrodef name="macro-undeploy-native421">
    <sequential>
      <fail message="Not available: ${jboss421.available.file}" unless="jboss421.available"/>
      <delete>
        
        <!-- BIN SCRIPTS -->
        <fileset dir="${jboss421.home}/bin">
          <patternset refid="bin.patternset"/>
        </fileset>
        
        <!-- CLIENT JARS -->
        <fileset dir="${jboss421.home}/client">
          <patternset refid="client.stack.patternset"/>
          <patternset refid="client.patternset"/>
          <patternset refid="bc.patternset"/>
          <!-- AS 4.2.1 specific jars -->
          <include name="jbossws-jboss421.jar"/>
          <include name="jboss-xml-binding.jar"/>
        </fileset>
        
        <!-- SERVER JARS -->
        <fileset dir="${jboss421.home}/lib">
          <patternset refid="bc.patternset"/>
          <!-- AS 4.2.1 specific jars -->
          <include name="jboss-xml-binding.jar"/>
        </fileset>
        <fileset dir="${jboss421.home}/server/${jboss.server.instance}/lib">
          <patternset refid="native.patternset"/>
          <patternset refid="bc.patternset"/>
          <!-- AS 4.2.1 specific jars -->
          <include name="jbossws-jboss421.jar"/>
        </fileset>
      </delete>
      <delete dir="${jboss421.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <delete dir="${jboss421.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <!-- ================================================================== -->
  <!-- Deployment  JBoss-4.2.2                                            -->
  <!-- ================================================================== -->
  
  <macrodef name="macro-deploy-native422">
    <attribute name="stacklibs"/>
    <attribute name="thirdpartylibs"/>
    <sequential>
      
      <!-- BIN SCRIPTS -->
      <unzip dest="${jboss422.home}/bin" src="@{stacklibs}/jbossws-core-scripts.zip"/>
      <chmod dir="${jboss422.home}/bin" perm="+x" includes="*.sh"/>
      
      <!-- CLIENT JARS -->
      <copy todir="${jboss422.home}/client" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="client.stack.patternset"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <patternset refid="client.patternset"/>
        </fileset>
      </copy>
      
      <!-- SERVER JARS -->
      <mkdir dir="${jboss422.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <unjar dest="${jboss422.home}/server/${jboss.server.instance}/deploy/jbossws.sar" src="@{stacklibs}/jbossws-native42.sar"/>
      <mkdir dir="${jboss422.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
      <unzip dest="${jboss422.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <macrodef name="macro-undeploy-native422">
    <sequential>
      
      <delete>
        
        <!-- BIN SCRIPTS -->
        <fileset dir="${jboss422.home}/bin">
          <patternset refid="bin.patternset"/>
        </fileset>
        
        <!-- CLIENT JARS -->
        <fileset dir="${jboss422.home}/client">
          <patternset refid="client.stack.patternset"/>
          <patternset refid="client.patternset"/>
          <patternset refid="bc.patternset"/>
        </fileset>
        
        <!-- SERVER JARS -->
        <fileset dir="${jboss422.home}/lib">
          <patternset refid="bc.patternset"/>
        </fileset>
        <fileset dir="${jboss422.home}/server/${jboss.server.instance}/lib">
          <patternset refid="native.patternset"/>
          <patternset refid="bc.patternset"/>
        </fileset>
      </delete>
      <delete dir="${jboss422.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <delete dir="${jboss422.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <!-- ================================================================== -->
  <!-- Deployment  JBoss-4.2.3                                            -->
  <!-- ================================================================== -->
  
  <macrodef name="macro-deploy-native423">
    <attribute name="stacklibs"/>
    <attribute name="thirdpartylibs"/>
    <sequential>
      
      <!-- BIN SCRIPTS -->
      <unzip dest="${jboss423.home}/bin" src="@{stacklibs}/jbossws-core-scripts.zip"/>
      <chmod dir="${jboss423.home}/bin" perm="+x" includes="*.sh"/>
      
      <!-- CLIENT JARS -->
      <copy todir="${jboss423.home}/client" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="client.stack.patternset"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <patternset refid="client.patternset"/>
        </fileset>
      </copy>
      
      <!-- SERVER JARS -->
      <mkdir dir="${jboss423.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <unjar dest="${jboss423.home}/server/${jboss.server.instance}/deploy/jbossws.sar" src="@{stacklibs}/jbossws-native42.sar"/>
      <mkdir dir="${jboss423.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
      <unzip dest="${jboss423.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <macrodef name="macro-undeploy-native423">
    <sequential>
      
      <delete>
        
        <!-- BIN SCRIPTS -->
        <fileset dir="${jboss423.home}/bin">
          <patternset refid="bin.patternset"/>
        </fileset>
        
        <!-- CLIENT JARS -->
        <fileset dir="${jboss423.home}/client">
          <patternset refid="client.stack.patternset"/>
          <patternset refid="client.patternset"/>
          <patternset refid="bc.patternset"/>
        </fileset>
        
        <!-- SERVER JARS -->
        <fileset dir="${jboss423.home}/lib">
          <patternset refid="bc.patternset"/>
        </fileset>
        <fileset dir="${jboss423.home}/server/${jboss.server.instance}/lib">
          <patternset refid="native.patternset"/>
          <patternset refid="bc.patternset"/>
        </fileset>
      </delete>
      <delete dir="${jboss423.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <delete dir="${jboss423.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <!-- ================================================================== -->
  <!-- Deployment  JBoss-5.0.0                                            -->
  <!-- ================================================================== -->
  
  <macrodef name="macro-deploy-native500">
    <attribute name="stacklibs"/>
    <attribute name="thirdpartylibs"/>
    <sequential>
      <fail message="Not available: ${jboss500.available.file}" unless="jboss500.available"/>
      
      <!-- BIN SCRIPTS -->
      <unzip dest="${jboss500.home}/bin" src="@{stacklibs}/jbossws-core-scripts.zip"/>
      <chmod dir="${jboss500.home}/bin" perm="+x" includes="*.sh"/>
      
      <!-- CLIENT JARS -->
      <copy todir="${jboss500.home}/client" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="client.stack.patternset"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <patternset refid="client.patternset"/>
        </fileset>
      </copy>

      <!-- BOOTSTRAP JARS -->
      <copy todir="${jboss500.home}/lib" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <patternset refid="lib.patternset"/>
        </fileset>
      </copy>
      
      <!-- SERVER JARS -->
      <copy todir="${jboss500.home}/server/${jboss.server.instance}/lib" overwrite="true">
        <fileset dir="@{stacklibs}">
          <patternset refid="native.patternset"/>
        </fileset>
      </copy>
      
      <mkdir dir="${jboss500.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <unjar dest="${jboss500.home}/server/${jboss.server.instance}/deploy/jbossws.sar" src="@{stacklibs}/jbossws-native50.sar"/>
      <mkdir dir="${jboss500.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
      <unzip dest="${jboss500.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <macrodef name="macro-undeploy-native500">
    <sequential>
      <fail message="Not available: ${jboss500.available.file}" unless="jboss500.available"/>
      
      <delete>
        <!-- BIN SCRIPTS -->
        <fileset dir="${jboss500.home}/bin">
          <patternset refid="bin.patternset"/>
        </fileset>
        
        <!-- CLIENT JARS -->
        <fileset dir="${jboss500.home}/client">
          <patternset refid="client.stack.patternset"/>
          <patternset refid="client.patternset"/>
          <patternset refid="bc.patternset"/>
        </fileset>
        
        <!-- BOOTSTRAP JARS -->
        <fileset dir="${jboss500.home}/lib">
          <patternset refid="lib.patternset"/>
        </fileset>

        <!-- SERVER JARS -->
        <fileset dir="${jboss500.home}/server/${jboss.server.instance}/lib">
          <patternset refid="native.patternset"/>
          <patternset refid="bc.patternset"/>
        </fileset>
      </delete>
      
      <delete dir="${jboss500.home}/server/${jboss.server.instance}/deploy/jbossws.sar"/>
      <delete dir="${jboss500.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
</project>
